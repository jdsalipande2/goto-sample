<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Order System</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Food Order System</h1>
    <div id="categories" class="categories-container"></div>
    <div id="menu-items" class="menu-container"></div>

    <script type="module">
        // Initialize Supabase Client
        import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";
        
        const supabaseUrl = "https://imsoflqfoidojyxfmtth.supabase.co";
        const supabaseKey = "your_supabase_key_here"; // Keep this key secure in production!
        const supabase = createClient(supabaseUrl, supabaseKey);

        // Function to fetch categories from Supabase
        async function fetchCategories() {
            let { data: categories, error } = await supabase.from("category").select("*");

            if (error) {
                console.error("Error fetching categories:", error);
                return;
            }
            displayCategories(categories);
        }

        // Display categories on the webpage
        function displayCategories(categories) {
            const categoriesContainer = document.getElementById("categories");
            categoriesContainer.innerHTML = "";
            categories.forEach(category => {
                let categoryElement = document.createElement("div");
                categoryElement.classList.add("category");
                categoryElement.innerHTML = `
                    <img src="${category.category_image}" alt="${category.category_name}">
                    <p>${category.category_name}</p>
                `;
                categoryElement.addEventListener("click", () => fetchMenuItems(category.category_id));
                categoriesContainer.appendChild(categoryElement);
            });
        }

        // Function to fetch menu items based on category
        async function fetchMenuItems(categoryId) {
            let { data: menuItems, error } = await supabase
                .from("menu")
                .select("*")
                .eq("category_id", categoryId)
                .eq("menu_availability", "yes");

            if (error) {
                console.error("Error fetching menu items:", error);
                return;
            }
            displayMenuItems(menuItems);
        }

        // Display menu items on the webpage
        function displayMenuItems(menuItems) {
            const menuContainer = document.getElementById("menu-items");
            menuContainer.innerHTML = "";
            menuItems.forEach(menu => {
                let menuElement = document.createElement("div");
                menuElement.classList.add("menu-item");
                menuElement.innerHTML = `
                    <img src="${menu.menu_image}" alt="${menu.menu_name}">
                    <h3>${menu.menu_name}</h3>
                    <p>${menu.menu_description}</p>
                    <p>Price: $${menu.menu_price}</p>
                    <button class="add-to-cart" data-id="${menu.menu_id}">Add to Cart</button>
                `;
                menuContainer.appendChild(menuElement);
            });

            document.querySelectorAll(".add-to-cart").forEach(button => {
                button.addEventListener("click", (e) => {
                    const menuId = e.target.getAttribute("data-id");
                    addToCart(menuId);
                });
            });
        }

        // Add menu item to cart
        function addToCart(menuId) {
            console.log(`Item ${menuId} added to cart!`);
        }

        // Fetch categories when the page loads
        fetchCategories();
    </script>
</body>
</html>
